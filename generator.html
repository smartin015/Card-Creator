<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Expedition Card Generator</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <link href='http://fonts.googleapis.com/css?family=Alfa+Slab+One|Permanent+Marker|Lora|Cinzel+Decorative:400,700' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Raleway:900' rel='stylesheet' type='text/css'>
    <link href='main.css' rel='stylesheet' type='text/css'>
  </head>

  <body>

    <script id="ability-template" type="text/x-handlebars-template">
      <div class="card ability">
        <div class="contents">
          <div class="title">{{ title }}</div>
          <div class="stat"><img src="img/{{ stat }}.svg"/></div>
          <div class="damageType">{{ type }}</div>
          <div class="targets">{{ targets }}</div>
          <div class="indicators">
            <div class="damage">{{ damage }}</div>
            <div class="risk">{{ risk }}</div>
          </div>
          <div class="effect">{{ effect }}</div>
          <div class="roleplay"><div class="prompt">Describe:</div>{{ describe }}</div>
        </div>
      </div>
    </script>


    <script src="http://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
    <script src="handlebars-v3.0.3.min.js"></script>
    <script src="generator.js"></script>
    <script src="svg.js"></script>
    <script>
    var templates = {};

    $(function() {
      templates.ability = Handlebars.compile($("#ability-template").html());

      $.ajax({
        url: "Expedition Cards - Abilities.tsv",
        async: false,
        success: function(data){
          var cards = filterEmpty(parse(data));
          // var keys = cards[0]; - row titles
          cards = cards.slice(1);
          makeAbilityCards(cards);
        }
      });

      // replace all .svg img tags with actual SVG
      SVGInjector(document.querySelectorAll('img.svg'), {}); 
    });

    function makeAbilityCards(cards) {
      for (var i = 0, l = cards.length; i < l; i++) {
        $("body").append(templates.ability(cards[i]));
      }
    }
    </script>
  </body>
</html>
<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Expedition Card Generator</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <link href='main.css' rel='stylesheet' type='text/css'>
    <link href='main.css' rel='stylesheet' type='text/css' media="print">
  </head>

  <body>

    <script id="ability-template" type="text/x-handlebars-template">
      <div class="card ability">
        <p class="title">{{ title }}</p>
        <p class="type">{{ type }}</p>
        <p class="damage">{{ damage }}</p>
        <p class="risk">{{ risk }}</p>
        <p class="effect">{{ effect }}</p>
      </div>
    </script>


    <script src="http://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
    <script src="handlebars-v3.0.3.min.js"></script>
    <script src="generator.js"></script>
    <script src="svg.js"></script>
    <script>
    var templates = {};

    $(function() {
      templates.ability = Handlebars.compile($("#ability-template").html());

      $.ajax({
        url: "test.tsv",
        async: false,
        success: function(data){
          var cards = filterEmpty(parse(data));
          // var keys = cards[0];
          cards = cards.slice(1);
          makeActionCards(cards);
        }
      });

      // replace all .svg img tags with actual SVG
      SVGInjector(document.querySelectorAll('img.svg'), {}); 
    });

    function makeActionCards(cards) {
      for (var i = 0, l = cards.length; i < l; i++) {
        $("body").append(templates.ability(cards[i]));
      }
    }
    </script>
  </body>
</html>
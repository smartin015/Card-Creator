<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Expedition Card Generator</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <link href='http://fonts.googleapis.com/css?family=Alfa+Slab+One|Permanent+Marker|Lora|Cinzel+Decorative:400,700' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Raleway:900' rel='stylesheet' type='text/css'>
    <link href='main.css' rel='stylesheet' type='text/css'>
  </head>

  <body>

    <script id="ability-template" type="text/x-handlebars-template">
      <div class="card ability">
        <div class="contents">
          <div class="title">{{ Title }}</div>
          <div class="type">{{ Type }}</div>
          <div class="targets">{{ Targets }}</div>
          <div class="indicators">
            <div class="damage">{{ Damage }}</div>
            <div class="risk">{{ Risk }}</div>
          </div>
          <div class="effect">{{ Effect }}</div>
          <div class="effect">{{ Usage }}</div>
          <div class="roleplay"><div class="prompt">Describe:</div>{{ Describe }}</div>
        </div>
      </div>
    </script>

    <script src="http://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
    <script src="handlebars-v3.0.3.min.js"></script>
    <script src="tabletop.js"></script>
    <script src="svg.js"></script>
    <script>
    var templates = {};

    $(function() {
      templates.ability = Handlebars.compile($("#ability-template").html());

      var public_spreadsheet_url = '1WvRrQUBRSZS6teOcbnCjAqDr-ubUNIxgiVwWGDcsZYM';
      Tabletop.init( { key: public_spreadsheet_url,
                     callback: function(data, tabletop){
          console.log(data);
          makeAbilityCards(data);
        }, simpleSheet: true});
        
      // replace all .svg img tags with actual SVG
      SVGInjector(document.querySelectorAll('img.svg'), {}); 
    });

    function makeAbilityCards(cards) {
      for (var i = 0, l = cards.length; i < l; i++) {
        if (cards[i].Comment != "") {
          continue;
        }
        $("body").append(templates.ability(cards[i]));
      }
    }
    </script>
  </body>
</html>